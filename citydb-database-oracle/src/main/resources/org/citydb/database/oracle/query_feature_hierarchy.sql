WITH FEATURE_HIERARCHY
    (ID,
     FEATURE_ID,
     PARENT_ID,
     DATATYPE_ID,
     NAMESPACE_ID,
     NAME,
     VAL_INT,
     VAL_DOUBLE,
     VAL_STRING,
     VAL_TIMESTAMP,
     VAL_URI,
     VAL_CODESPACE,
     VAL_UOM,
     VAL_ARRAY,
     VAL_LOD,
     VAL_GEOMETRY_ID,
     VAL_IMPLICITGEOM_ID,
     VAL_IMPLICITGEOM_REFPOINT,
     VAL_APPEARANCE_ID,
     VAL_ADDRESS_ID,
     VAL_FEATURE_ID,
     VAL_RELATION_TYPE,
     VAL_CONTENT,
     VAL_CONTENT_MIME_TYPE)
    AS
  (SELECT NULL AS ID,
     ID AS FEATURE_ID,
     NULL AS PARENT_ID,
     NULL AS DATATYPE_ID,
     NULL AS NAMESPACE_ID,
     NULL AS NAME,
     NULL AS VAL_INT,
     NULL AS VAL_DOUBLE,
     NULL AS VAL_STRING,
     NULL AS VAL_TIMESTAMP,
     NULL AS VAL_URI,
     NULL AS VAL_CODESPACE,
     NULL AS VAL_UOM,
     NULL AS VAL_ARRAY,
     NULL AS VAL_LOD,
     NULL AS VAL_GEOMETRY_ID,
     NULL AS VAL_IMPLICITGEOM_ID,
     NULL AS VAL_IMPLICITGEOM_REFPOINT,
     NULL AS VAL_APPEARANCE_ID,
     NULL AS VAL_ADDRESS_ID,
     ID AS VAL_FEATURE_ID,
     1 AS VAL_RELATION_TYPE,
     NULL AS VAL_CONTENT,
     NULL AS VAL_CONTENT_MIME_TYPE
   FROM (SELECT ? AS ID) F
   UNION ALL SELECT
     P.ID,
     P.FEATURE_ID,
     P.PARENT_ID,
     P.DATATYPE_ID,
     P.NAMESPACE_ID,
     P.NAME,
     P.VAL_INT,
     P.VAL_DOUBLE,
     P.VAL_STRING,
     P.VAL_TIMESTAMP,
     P.VAL_URI,
     P.VAL_CODESPACE,
     P.VAL_UOM,
     P.VAL_ARRAY,
     P.VAL_LOD,
     P.VAL_GEOMETRY_ID,
     P.VAL_IMPLICITGEOM_ID,
     P.VAL_IMPLICITGEOM_REFPOINT,
     P.VAL_APPEARANCE_ID,
     P.VAL_ADDRESS_ID,
     P.VAL_FEATURE_ID,
     P.VAL_RELATION_TYPE,
     P.VAL_CONTENT,
     P.VAL_CONTENT_MIME_TYPE
   FROM @SCHEMA@.PROPERTY P
   INNER JOIN FEATURE_HIERARCHY H ON H.VAL_FEATURE_ID = P.FEATURE_ID AND H.VAL_RELATION_TYPE = 1
  )
CYCLE ID SET IS_CYCLE to TRUE DEFAULT FALSE
SELECT
  H.ID,
  H.FEATURE_ID,
  H.PARENT_ID,
  H.DATATYPE_ID,
  H.NAMESPACE_ID,
  H.NAME,
  H.VAL_INT,
  H.VAL_DOUBLE,
  H.VAL_STRING,
  H.VAL_TIMESTAMP,
  H.VAL_URI,
  H.VAL_CODESPACE,
  H.VAL_UOM,
  H.VAL_ARRAY,
  H.VAL_LOD,
  H.VAL_GEOMETRY_ID,
  H.VAL_IMPLICITGEOM_ID,
  H.VAL_IMPLICITGEOM_REFPOINT,
  H.VAL_APPEARANCE_ID,
  H.VAL_ADDRESS_ID,
  H.VAL_FEATURE_ID,
  H.VAL_RELATION_TYPE,
  H.VAL_CONTENT,
  H.VAL_CONTENT_MIME_TYPE
FROM FEATURE_HIERARCHY H
WHERE NOT IS_CYCLE;


